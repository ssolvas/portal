<!DOCTYPE html>
<html xml:lang="ca-ES" lang="ca-ES" xmlns="http://www.w3.org/1999/xhtml">
<head>

	<title>Mòdul d&#39;excepcions</title>
		<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
	<link href="/css/master.min.css" rel="stylesheet" type="text/css" />
	<link href="/css/canigo.css" rel="stylesheet" type="text/css" />
	<script src="/js/jquery.min.js" type="text/javascript"></script>

	<script>
		document.write("<meta name=\"titol\" content=\"Mòdul d\x27excepcions\" />");
		document.write("<meta name=\"description\" content=\"Mòdul per a la gestió d\x27excepcions de les aplicacions\" />");
	</script>

	

</head>
<body class="single">
	<div class="contenidor unfixed">

				

		<header class="fons_header navbar navbar-default z-index-menu">
			<div class="container" role="menu">
				<div class="row clearfix menuNav">
					<div class="col-md-3 col-xs-3 column visible-xs coloca ">
						<button type="button" onclick="amunt();" title="Menu"
							class="navbar-toggle pull-left" data-toggle="collapse"
							data-target=".navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span
								class="icon-bar"></span> <span class="icon-bar"></span> <span
								class="icon-bar"></span>
						</button>
					</div>

					<div class="col-md-3 col-xs-6 col-offset-2 column visible-xs titol-mobil">
						
						<span class="white titol-mobil-destacat">canigo.ctti</span><span class="white">.gencat.cat</span>
					</div>

					<div class="col-md-3 col-xs-3 column visible-xs coloca1">
						<button onclick="amunt();" type="button" title="Cerca"
							class="ico_cerca " data-toggle="collapse" data-target=".dos">
						</button>
					</div>

				</div>

				<div class="collapse dos">
					<div class="shadowBox">
						<form class="navbar-form navbar-left primer" action="/cercador/" method="get"
 						onsubmit="location.href=this.action+'?q='+this.cerca_cap.value; return false;">
							<div class="form-group">
								<input type="search" class="form-control" name="q" id="cerca_cap"
									title="Cerca"
									placeholder="Cerca" />
								<button type="button" title="Neteja" class="btn btn-default"></button>
								<input type="submit" class="ocult" name="Cerca" value="Cerca" />
							</div>
						</form>
					</div>
				</div>	

				<nav class="collapse navbar-collapse navbar-ex1-collapse ">
				
					<div class="row">
						<div class="col-md-6 col-sm-4 column">
							<a class="img-responsive logo" title="Generalitat de Catalunya"
								href="https://ctti.gencat.cat/">gencat.cat</a>
							<button class="menu_tancar visible-xs collapsed"
								data-target=".navbar-collapse" data-toggle="collapse"
								title="Tancar"></button>
						</div>

						<div class="col-md-6 col-sm-8 column hidden-xs hidden-mg">
							<form class="navbar-form cercador_vermell hidden-xs pull-right" action="/cercador/"  method="get" onsubmit="location.href=this.action+'?q='+this.cerca2.value; return false;">
								<div class="form-group">
									<label class="hidden" for="cerca2">Cerca</label>
									<input id="cerca2" class="form-control" type="search" 
									placeholder="Cerca" name="q" title="Cerca">
									<input class="btn btn-default" type="submit" title="Cerca" value="">
								</div>
							</form>

							

						</div>

					</div>
					<div class="col-xs-12 hidden-xs" id="nomPortal">
                    	<span class="titol-cap-nou">Centre de Telecomunicacions i Tecnologies de la Informació</span>
                    </div>					
					<ul class="nav navbar-nav">

			        	

						<li>
							<a class="dropdown-toggle" href='/' data-toggle='_dropdown'>Inici</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/arqctti' data-toggle='_dropdown'>Arquitectura CTTI</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/blog' data-toggle='_dropdown'>Blog</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cloud' data-toggle='_dropdown'>Cloud</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/canigo' data-toggle='_dropdown'>Canigó</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sic' data-toggle='_dropdown'>SIC</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sgde' data-toggle='_dropdown'>SGDE</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/gicar' data-toggle='_dropdown'>GICAR</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cs' data-toggle='_dropdown'>Centres de Suport</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/dadesref' data-toggle='_dropdown'>Gestió Tècnica de Dades</a>
						</li>

						

					</ul>

				</nav>
			</div>
		</header>



	</div>

	<section class="border-start">

						
			

			<article class="bgGrey">
				<div class="container">
					<div class="row">
						<div class="capcelera_basica col-sm-12">
							<div class="capcelera_basica_cont">
								<ol class="breadcrumb filariana hidden-xs">
									<li>
										<a href="/">Inici</a>
									</li>
									<li class="breadcrumbs2">
									
										<a href="/drafts">
											




























										</a>
										




























































































									
									</li>

								</ol>

								<h1 class="capcelera_flotant pull-left" data-txt=".title">
									

										
											




	Mòdul d&#39;excepcions


										

									
								</h1>

								

								
								

								

								

							</div>
						</div>

					</div>
				</div>
			</article>

			


		   <div class="padding-xs container">
	    	
	    	   <i><b>Darrera actualització:</b></i> 07-10-2020
	        
           </div>
           
			<article class="padding-xs padding-sm padding-md contingut">				
				<div class="container">
 		
					
				

	


					

						

<h2 id="propòsit">Propòsit</h2>

<p>La <strong>correcta gestió de les excepcions és molt important i crítica</strong> però, sovint, la forma en la que es generen i gestionen les excepcions en les aplicacions
és un dels aspectes més ignorats en el disseny de les mateixes. L&rsquo;ús apropiat de les excepcions fa que els nostres aplicatius siguin més robusts, més fàcils de
desenvolupar i mantenir, més lliures d&rsquo;errors i més fàcils d&rsquo;utilitzar. Per aquest motiu és important que tractem excepcions al màxim nivell de detall.</p>

<p>El <strong>mòdul d&rsquo;excepcions de Canigó permet gestionar els errors que es produeixen en realitzar una petició</strong> de forma que aquests podran ser tractats adequadament i, si convé,
informar a l&rsquo;usuari, enregistrar una traça, enviar un correu electrònic&hellip; etcètera. Per tal d&rsquo;evitar l&rsquo;ús innecessari de blocs <em>try-catch</em> dins el codi dels nostres
aplicatius, Canigó <strong>proporciona un mecanisme d&rsquo;intercepció</strong>, al qual indicarem quines excepcions volem tractar i quins gestors les tractaran sense haver d&rsquo;incorporar
cap referència a les classes de l&rsquo;aplicació.</p>

<h2 id="glossari">Glossari</h2>

<h2 id="instal-lació">Instal·lació</h2>

<p>El mòdul de configuració s&rsquo;inclou per defecte dins del core de Canigó 3.
Durant el procés de creació de l&rsquo;aplicació, l&rsquo;eina de suport al desenvolupament inclourà la referència dins el fitxer <code>pom.xml</code> i, en cas d&rsquo;una instal·lació manual,
caldrà afegir les següents entrades al fitxer:</p>

<pre><code>&lt;canigo.core.version&gt;[4.0.0,4.4.0)&lt;/canigo.core.version&gt;
&lt;canigo.web.rs.version&gt;[1.2.0,1.3.0)&lt;/canigo.web.rs.version&gt;
&lt;dependency&gt;
          &lt;groupId&gt;cat.gencat.ctti&lt;/groupId&gt;
          &lt;artifactId&gt;canigo.core&lt;/artifactId&gt;
          &lt;version&gt;${canigo.core.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
   &lt;groupId&gt;cat.gencat.ctti&lt;/groupId&gt;
   &lt;artifactId&gt;canigo.web.rs&lt;/artifactId&gt;
   &lt;version&gt;${canigo.web.rs.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h2 id="classes-disponibles-d-excepcions">Classes disponibles d&rsquo;excepcions</h2>

<p>Les classes disponibles, i la seva jerarquia, es mostren a continuació:</p>

<p><img src="/related/canigo/documentacio/modul-excepcions/jerarquia_exception.png" alt="Imatge de les Excepcions Definides" /></p>

<p>És a dir:</p>

<pre><code>public class BaseException extends Exception implements IBaseException
public class BusinessException extends BaseException
public class CoreException extends RuntimeException implements IBaseException
public class ModuleException extends BaseException
public class RuntimeModuleException extends RuntimeException implements IBaseException
public class WrappedCheckedException extends CoreException
public class ResourceNotFoundException extends RuntimeException
</code></pre>

<p>Cada excepció té el seu objectiu, sent de tipus <em>checked</em> o <em>unchecked</em>. Per lo que, si s&rsquo;ha de definir una nova excepció a l&rsquo;aplicació,
segons quin sigui l&rsquo;objectiu de la mateixa s&rsquo;hauria de decidir estendre d&rsquo;una o d&rsquo;una altra.</p>

<h2 id="handlers-disponibles">Handlers disponibles</h2>

<p>Per a serveis Rest, Canigó proporciona un <em>handler</em> global a l&rsquo;objecte <em>cat.gencat.ctti.canigo.arch.web.rs.controller.exception.handler.GlobalDefaultExceptionHandler</em>.
Aquest és l&rsquo;encarregat de capturar les següents excepcions:</p>

<ul>
<li><p><strong>java.lang.Exception</strong>: capturada al mètode <em>defaultErrorHandlerException</em>, que retorna un error http 500-Error intern.</p></li>

<li><p><strong>org.springframework.web.multipart.MultipartException</strong>: capturada al mètode <em>defaultErrorHandlerMultipartException</em>, que retorna un
error http 400-Bad Request.</p></li>

<li><p><strong>org.springframework.web.multipart.MultipartException</strong>: capturada al mètode <em>defaultErrorHandlerMultipartException</em> que retorna un
error http 400-Bad Request.</p></li>

<li><p><strong>org.springframework.security.core.AuthenticationException</strong> i <strong>org.springframework.security.access.AccessDeniedException</strong>: capturades
al mètode <em>defaultErrorHandlerAuthenticationException</em> que retorna un error http 401-Unathorized.</p></li>

<li><p><strong>cat.gencat.ctti.canigo.arch.web.rs.controller.exception.ResourceNotFoundException</strong>: capturada al mètode <em>resourceNotFound</em> que retorna un
error http 404-Not found.</p></li>
</ul>

<p>En tots els casos, l&rsquo;error s&rsquo;informa al <em>body</em> de la resposta utilitzant un objecte <em>cat.gencat.ctti.canigo.arch.web.rs.response.ResponseError</em>.
Si es vol sobreescriure el comportament per defecte es pot estendre aquesta classe i sobreescriure el mètode que es necessiti.</p>

<h3 id="exemple">Exemple</h3>

<p>Si es vol retornar un missatge d&rsquo;error o un codi http en concret per un tipus d&rsquo;error, per exemple en una validació de paràmetres d&rsquo;un servei Rest,
serà necessari:</p>

<ul>
<li>1. Definir una excepció pròpia. Per exemple: ValidationException</li>
<li>2. Definir l’<em>@ExceptionHandler</em> propi de cada excepció a l&rsquo;aplicació que, en aquest cas, seria un <em>@ExceptionHandler</em> de ValidationException.</li>
</ul>

<pre><code>   @ExceptionHandler(ValidationException.class)
   @ResponseStatus(value = HttpStatus.BAD_REQUEST)
   public ResponseError defaultErrorHandlerValidationException(final HttpServletRequest request,
         final HttpServletResponse response, final ValidationException e) {
      if (log.isDebugEnabled()) {
         log.debug(&quot;defaultErrorHandlerValidationException request {} response {}&quot;, request, response);
      }
      return new ResponseError(e.getErrors());
   }
</code></pre>


					

					
				</div>	

			</article>	


	</section>	

		<div class="fons_footer ">
		<footer class="container center-block shadowBox2">
			<div class="shadow2"></div>
			<div class="row footer_tab_ord">

				<div class="footer_tab_bot col-sm-12">
					<div class="avis_legal">

						<div id="fAvisLegal">
							<div>
								<div class="hidden-xs">
									<a href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" alt="www.gencat.cat"
										/></a>
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								<div class="visible-xs avis_legal">
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								
								<div class="fi_peu visible-xs">
									<a title="www.gencat.cat" href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" 
										alt="www.gencat.cat" /></a> <a class="torna_amunt pull-right"
										href=" javascript:tornarAmunt();" title="Torna amunt">
										<p>Torna amunt</p>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</footer>
	</div>

<script src="/js/master.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
<script src="/js/custom.js" type="text/javascript"></script>



<script type="text/javascript">

if(location.hostname!=="localhost"){

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', "UA-59408075-1", 'auto');
	ga('send', 'pageview', {
	  	'page': location.pathname + location.search  + location.hash
	  }
	);

}

</script>




</body>
</html>
