<!DOCTYPE html>
<html xml:lang="ca-ES" lang="ca-ES" xmlns="http://www.w3.org/1999/xhtml">
<head>

	<title>Orquestradors de contenidors</title>
		<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
	<link href="/css/master.min.css" rel="stylesheet" type="text/css" />
	<link href="/css/canigo.css" rel="stylesheet" type="text/css" />
	<script src="/js/jquery.min.js" type="text/javascript"></script>

	<script>
		document.write("<meta name=\"titol\" content=\"Orquestradors de contenidors\" />");
		document.write("<meta name=\"description\" content=\"Consideracions respecte als orquestradors de contenidors\" />");
	</script>

	

</head>
<body class="single">
	<div class="contenidor unfixed">

				

		<header class="fons_header navbar navbar-default z-index-menu">
			<div class="container" role="menu">
				<div class="row clearfix menuNav">
					<div class="col-md-3 col-xs-3 column visible-xs coloca ">
						<button type="button" onclick="amunt();" title="Menu"
							class="navbar-toggle pull-left" data-toggle="collapse"
							data-target=".navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span
								class="icon-bar"></span> <span class="icon-bar"></span> <span
								class="icon-bar"></span>
						</button>
					</div>

					<div class="col-md-3 col-xs-6 col-offset-2 column visible-xs titol-mobil">
						
						<span class="white titol-mobil-destacat">canigo.ctti</span><span class="white">.gencat.cat</span>
					</div>

					<div class="col-md-3 col-xs-3 column visible-xs coloca1">
						<button onclick="amunt();" type="button" title="Cerca"
							class="ico_cerca " data-toggle="collapse" data-target=".dos">
						</button>
					</div>

				</div>

				<div class="collapse dos">
					<div class="shadowBox">
						<form class="navbar-form navbar-left primer" action="/cercador/" method="get"
 						onsubmit="location.href=this.action+'?q='+this.cerca_cap.value; return false;">
							<div class="form-group">
								<input type="search" class="form-control" name="q" id="cerca_cap"
									title="Cerca"
									placeholder="Cerca" />
								<button type="button" title="Neteja" class="btn btn-default"></button>
								<input type="submit" class="ocult" name="Cerca" value="Cerca" />
							</div>
						</form>
					</div>
				</div>	

				<nav class="collapse navbar-collapse navbar-ex1-collapse ">
				
					<div class="row">
						<div class="col-md-6 col-sm-4 column">
							<a class="img-responsive logo" title="Generalitat de Catalunya"
								href="https://ctti.gencat.cat/">gencat.cat</a>
							<button class="menu_tancar visible-xs collapsed"
								data-target=".navbar-collapse" data-toggle="collapse"
								title="Tancar"></button>
						</div>

						<div class="col-md-6 col-sm-8 column hidden-xs hidden-mg">
							<form class="navbar-form cercador_vermell hidden-xs pull-right" action="/cercador/"  method="get" onsubmit="location.href=this.action+'?q='+this.cerca2.value; return false;">
								<div class="form-group">
									<label class="hidden" for="cerca2">Cerca</label>
									<input id="cerca2" class="form-control" type="search" 
									placeholder="Cerca" name="q" title="Cerca">
									<input class="btn btn-default" type="submit" title="Cerca" value="">
								</div>
							</form>

							

						</div>

					</div>
					<div class="col-xs-12 hidden-xs" id="nomPortal">
                    	<span class="titol-cap-nou">Centre de Telecomunicacions i Tecnologies de la Informació</span>
                    </div>					
					<ul class="nav navbar-nav">

			        	

						<li>
							<a class="dropdown-toggle" href='/' data-toggle='_dropdown'>Inici</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/arqctti' data-toggle='_dropdown'>Arquitectura CTTI</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/blog' data-toggle='_dropdown'>Blog</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cloud' data-toggle='_dropdown'>Cloud</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/canigo' data-toggle='_dropdown'>Canigó</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sic' data-toggle='_dropdown'>SIC</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sgde' data-toggle='_dropdown'>SGDE</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/gicar' data-toggle='_dropdown'>GICAR</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cs' data-toggle='_dropdown'>Centres de Suport</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/dadesref' data-toggle='_dropdown'>Gestió Tècnica de Dades</a>
						</li>

						

					</ul>

				</nav>
			</div>
		</header>



	</div>

	<section class="border-start">

						
			

			<article class="bgGrey">
				<div class="container">
					<div class="row">
						<div class="capcelera_basica col-sm-12">
							<div class="capcelera_basica_cont">
								<ol class="breadcrumb filariana hidden-xs">
									<li>
										<a href="/">Inici</a>
									</li>
									<li class="breadcrumbs2">
									
										<a href="/cloud-caas">
											




























										</a>
										




























































































									
									</li>

								</ol>

								<h1 class="capcelera_flotant pull-left" data-txt=".title">
									

										
											




	Orquestradors de contenidors


										

									
								</h1>

								

								
								

								

								

							</div>
						</div>

					</div>
				</div>
			</article>

			


		   <div class="padding-xs container">
	    	
	    	   <i><b>Darrera actualització:</b></i> 12-06-2020
	        
           </div>
           
			<article class="padding-xs padding-sm padding-md contingut">				
				<div class="container">
 		
					
				

	


					

						

<h2 id="introducció">Introducció</h2>

<p>En un entorn productiu, el desplegament utilitzant contenidors, moltes vegades no és suficient, és necessari disposar d&rsquo;un conjunt de recursos addicionals que siguin capaços d&rsquo;oferir un nivell de servei prou bo.
Aquests recursos són oferts pels orquestradors.
Al mercar existeixen diferents eines per orquestrar els contenidors docker.
La Generalitat de Catalunya dóna suport als següents orquestradors:</p>

<ul>
<li>Openshift</li>
<li>Kubernetes</li>
<li>SwarmMe (basat en Swarm)</li>
</ul>

<p>Tot i que conceptualment tenen molts punts en comú, cadascun d&rsquo;aquests orquestradors presenta components i maneres de treballar particulars.
En aquest article es defineix la manera de treballar i els components a utilitzar en cada orquestrador amb l&rsquo;objectiu de minimitzar l&rsquo;esforç necessari.</p>

<h2 id="aspectes-bàsics">Aspectes bàsics</h2>

<p>En un entorn productiu de contenidors, cal tenir present un conjunt d&rsquo;aspectes més enllà dels propis contenidors.
Els orquestradors ens ajudaran a assolir alguns dels següents aspectes.</p>

<h3 id="registre">Registre</h3>

<p>Les imatges de contenidors, un cop creades a partir del Dockerfile, cal repositar-les en un registre.
Docker ofereix un registre públic amb imatges de tot tipus oferides per fabricants de productes i col·laboradors particulars. És el <a href="https://hub.docker.com/">Docker Hub</a>.
Per repositar les imatges privades fruit dels diferents desenvolupaments de projectes, cal tenir un registre privat que només permeti accedir a les imatges als usuaris autoritzats.</p>

<h3 id="seguretat">Seguretat</h3>

<p>Els contenidors docker s&rsquo;executen sobre el Docker Engine. Tot i que els contenidors són bastant segurs i cap a fora de la màquina on s&rsquo;executen només exposen els ports que es defineixen al Dockerfile, si tenim diverses aplicacions, cadascuna amb diversos contenidors cal afegir una capa de seguretat entre elles.
Addicionalment cal establir una capa de seguretat a la gestió de les diferents aplicacions de manera que cada aplicació pugui ser administrada per un tenant sense que altres tenants puguin accedir a ella.</p>

<h3 id="alta-disponibilitat-i-escalat">Alta disponibilitat i escalat</h3>

<p>Els contenidors docker en si, no ofereixen alta disponibilitat. No està inclòs al concepte de contenidor. La idea per alta disponibilitat és realitzar escalat horitzontal de 2 o més contenidors idèntics.
És necessari un component extern que controli el nombre de contenidors aixecats contínuament.</p>

<h3 id="balanceig">Balanceig</h3>

<p>Quan es disposen de més d&rsquo;un contenidor d&rsquo;un tipus, és necessari disposar d&rsquo;un element que faci balanceig entre els diversos contenidors.</p>

<h3 id="serveis">Serveis</h3>

<p>Els contenidors de docker s&rsquo;exposen com a serveis a través de paràmetres a la comanda d&rsquo;execució dels contenidors, mapejant ports interns del container amb ports externs del host. És necessària una capa addicional que permeti gestionar d&rsquo;una manera una mica més àgil i flexible aquesta exposició.</p>

<h3 id="enrutament">Enrutament</h3>

<p>Addicionalment al balanceig, és necessari disposar d&rsquo;un element enrutador que permeti:</p>

<ul>
<li>Configurar certificats SSL</li>
<li>Enrutar el transit entre diferents xarxes per oferir per exemple serveis només intranet o internet</li>
</ul>

<h3 id="emmagatzematge">Emmagatzematge</h3>

<p>L&rsquo;emmagatzematge als contenidors s&rsquo;estableix a través dels volums. És necessària una gestió addicional dels mateixos que ofereixin una millor granularitat a l&rsquo;hora de proveir l&rsquo;emmagatzematge des de diferents fonts.</p>

<h3 id="monitorizació-de-recursos-i-logs">Monitorizació de recursos i logs</h3>

<p>Els contenidors Docker normalment es configuren per a què els logs s&rsquo;enviïn a la sortida estàndard. Quan existeix un volum elevat de containers, la monitorització es pot complicar molt. És necessària algun tipus d&rsquo;eina que faciliti aquesta monitorització.</p>

<h3 id="quotes">Quotes</h3>

<p>Els contenidors dockers, no tenen cap tipus de quota definida. Poden consumir tots els recursos de maquinari que requereixin. Per garantir l&rsquo;estabilitat dels entorns productius, és necessari que hi hagi algun component que pugui limitar el consum de recursos de cada contenidor.</p>

<h3 id="desplegament">Desplegament</h3>

<p>Actualment els cicles de vida de desenvolupament d&rsquo;aplicacions van cap a models CI/CD i DevOps.
La Generalitat de Catalunya disposa de l&rsquo;eina SIC per realitzar els desplegaments.
Són necessàries eines que facilitin la integració d&rsquo;un model de basat en contenidors amb eines de CI/CD com el SIC.</p>

<h2 id="comparativa-entre-orquestradors">Comparativa entre orquestradors</h2>

<h3 id="característiques">Característiques</h3>

<p>Al següent diagrama es descriu:</p>

<ul>
<li>Principals components de cada orquestrador</li>
<li>Correspondències entre els components de cada orquestrador</li>
<li>Components permesos a la Generalitat de Catalunya</li>
</ul>

<p><img src="/related/cloud/comparativaOrquestradors.png" alt="comparativa entre Orquestradors docker" /></p>

<h2 id="descripció-dels-orquestradors">Descripció dels orquestradors</h2>

<h3 id="swarmme">SwarmMe</h3>

<p>Està basat en Swarm.
Swarm és l&rsquo;orquestrador oficial de docker. Actualment és el menys evolucionat dels tres.
SwarmMe complementa alguna de les mancances que Swarm presenta (Registre, Sistema centralitzat de logs, eines de desplegament, &hellip;)</p>

<p>Per més informació podeu consultar <a href="https://docs.docker.com/engine/swarm/">https://docs.docker.com/engine/swarm/</a></p>

<h3 id="kubernetes">Kubernetes</h3>

<p>Va ser creat per Google.
Actualment està evolucionant molt.
Recentment ha rebut el suport oficial de docker.</p>

<p>Per detalls i exemples podeu visitar la plana <a href="http://canigo.ctti.gencat.cat/cloud-caas/contenidors_kubernetes/">http://canigo.ctti.gencat.cat/cloud-caas/contenidors_kubernetes/</a></p>

<p>Per més informació podeu consultar la web <a href="https://kubernetes.io/">https://kubernetes.io/</a></p>

<h3 id="openshift">Openshift</h3>

<p>Desenvolupat per Red Hat, basat en Kubernetes.
Afegeix funcionalitat addicional a Kubernetes (gestió d&rsquo;usuaris, segmentació de xarxa, sistema centralitzat de logs).
Acostuma a portar un endarreriment respecte a l&rsquo;última versió de kubernetes d&rsquo;uns tres o quatre mesos.</p>

<p>Per detalls i exemples podeu visitar la plana <a href="http://canigo.ctti.gencat.cat/cloud-caas/contenidors_openshift/">Contenidors Openshift</a></p>

<p>Per més informació podeu consultar les webs:</p>

<ul>
<li><a href="https://docs.openshift.com/container-platform/4.6/welcome/index.html">https://docs.openshift.com/container-platform/4.6/welcome/index.html</a></li>
</ul>

<h2 id="imatges">Imatges</h2>

<p>A l&rsquo;hora de construir les imatges docker, cal tenir present els criteris definits per la Generalitat de Catalunya i que cada orquestrador, tot i que totes les plataformes es basen en docker, té les seves particularitats.</p>

<p>A la plana <a href="http://canigo.ctti.gencat.cat/cloud-caas/dockerImages/">Criteris creació contenidors docker</a> podeu trobar més informació al respecte.</p>


					

					
				</div>	

			</article>	


	</section>	

		<div class="fons_footer ">
		<footer class="container center-block shadowBox2">
			<div class="shadow2"></div>
			<div class="row footer_tab_ord">

				<div class="footer_tab_bot col-sm-12">
					<div class="avis_legal">

						<div id="fAvisLegal">
							<div>
								<div class="hidden-xs">
									<a href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" alt="www.gencat.cat"
										/></a>
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								<div class="visible-xs avis_legal">
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								
								<div class="fi_peu visible-xs">
									<a title="www.gencat.cat" href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" 
										alt="www.gencat.cat" /></a> <a class="torna_amunt pull-right"
										href=" javascript:tornarAmunt();" title="Torna amunt">
										<p>Torna amunt</p>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</footer>
	</div>

<script src="/js/master.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
<script src="/js/custom.js" type="text/javascript"></script>



<script type="text/javascript">

if(location.hostname!=="localhost"){

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', "UA-59408075-1", 'auto');
	ga('send', 'pageview', {
	  	'page': location.pathname + location.search  + location.hash
	  }
	);

}

</script>




</body>
</html>
