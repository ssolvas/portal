<!DOCTYPE html>
<html xml:lang="ca-ES" lang="ca-ES" xmlns="http://www.w3.org/1999/xhtml">
<head>

	<title>2.- Servei d’autenticació amb certificat digital per usuaris que no estan a GICAR</title>
		<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
	<link href="/css/master.min.css" rel="stylesheet" type="text/css" />
	<link href="/css/canigo.css" rel="stylesheet" type="text/css" />
	<script src="/js/jquery.min.js" type="text/javascript"></script>

	<script>
		document.write("<meta name=\"titol\" content=\"2.- Servei d’autenticació amb certificat digital per usuaris que no estan a GICAR\" />");
		document.write("<meta name=\"description\" content=\"Servei d\x27autenticació anònima\" />");
	</script>

	

</head>
<body class="single">
	<div class="contenidor unfixed">

				

		<header class="fons_header navbar navbar-default z-index-menu">
			<div class="container" role="menu">
				<div class="row clearfix menuNav">
					<div class="col-md-3 col-xs-3 column visible-xs coloca ">
						<button type="button" onclick="amunt();" title="Menu"
							class="navbar-toggle pull-left" data-toggle="collapse"
							data-target=".navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span
								class="icon-bar"></span> <span class="icon-bar"></span> <span
								class="icon-bar"></span>
						</button>
					</div>

					<div class="col-md-3 col-xs-6 col-offset-2 column visible-xs titol-mobil">
						
						<span class="white titol-mobil-destacat">canigo.ctti</span><span class="white">.gencat.cat</span>
					</div>

					<div class="col-md-3 col-xs-3 column visible-xs coloca1">
						<button onclick="amunt();" type="button" title="Cerca"
							class="ico_cerca " data-toggle="collapse" data-target=".dos">
						</button>
					</div>

				</div>

				<div class="collapse dos">
					<div class="shadowBox">
						<form class="navbar-form navbar-left primer" action="/cercador/" method="get"
 						onsubmit="location.href=this.action+'?q='+this.cerca_cap.value; return false;">
							<div class="form-group">
								<input type="search" class="form-control" name="q" id="cerca_cap"
									title="Cerca"
									placeholder="Cerca" />
								<button type="button" title="Neteja" class="btn btn-default"></button>
								<input type="submit" class="ocult" name="Cerca" value="Cerca" />
							</div>
						</form>
					</div>
				</div>	

				<nav class="collapse navbar-collapse navbar-ex1-collapse ">
				
					<div class="row">
						<div class="col-md-6 col-sm-4 column">
							<a class="img-responsive logo" title="Generalitat de Catalunya"
								href="https://ctti.gencat.cat/">gencat.cat</a>
							<button class="menu_tancar visible-xs collapsed"
								data-target=".navbar-collapse" data-toggle="collapse"
								title="Tancar"></button>
						</div>

						<div class="col-md-6 col-sm-8 column hidden-xs hidden-mg">
							<form class="navbar-form cercador_vermell hidden-xs pull-right" action="/cercador/"  method="get" onsubmit="location.href=this.action+'?q='+this.cerca2.value; return false;">
								<div class="form-group">
									<label class="hidden" for="cerca2">Cerca</label>
									<input id="cerca2" class="form-control" type="search" 
									placeholder="Cerca" name="q" title="Cerca">
									<input class="btn btn-default" type="submit" title="Cerca" value="">
								</div>
							</form>

							

						</div>

					</div>
					<div class="col-xs-12 hidden-xs" id="nomPortal">
                    	<span class="titol-cap-nou">Centre de Telecomunicacions i Tecnologies de la Informació</span>
                    </div>					
					<ul class="nav navbar-nav">

			        	

						<li>
							<a class="dropdown-toggle" href='/' data-toggle='_dropdown'>Inici</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/arqctti' data-toggle='_dropdown'>Arquitectura CTTI</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/blog' data-toggle='_dropdown'>Blog</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cloud' data-toggle='_dropdown'>Cloud</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/canigo' data-toggle='_dropdown'>Canigó</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sic' data-toggle='_dropdown'>SIC</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sgde' data-toggle='_dropdown'>SGDE</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/gicar' data-toggle='_dropdown'>GICAR</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cs' data-toggle='_dropdown'>Centres de Suport</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/dadesref' data-toggle='_dropdown'>Gestió Tècnica de Dades</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/eventhub' data-toggle='_dropdown'>EventHub</a>
						</li>

						

					</ul>

				</nav>
			</div>
		</header>



	</div>

	<section class="border-start">

						
			

			<article class="bgGrey">
				<div class="container">
					<div class="row">
						<div class="capcelera_basica col-sm-12">
							<div class="capcelera_basica_cont">
								<ol class="breadcrumb filariana hidden-xs">
									<li>
										<a href="/">Inici</a>
									</li>
									<li class="breadcrumbs2">
									
										<a href="/gicar-novesintegracions-funcionalitats-autenticacio">
											




























										</a>
										



























































































	<a href="/gicar/">GICAR</a> </li>

	<li>
		<a href="/gicar-novesintegracions/">Modalitats d'integració possibles</a>
	</li>

	<li>
	
		<a href="/gicar-novesintegracions-funcionalitats-autenticacio/">
	

	Possibilitats funcionals d'integració amb GICAR

	
		</a>
	



									
									</li>

								</ol>

								<h1 class="capcelera_flotant pull-left" data-txt=".title">
									

										
											




	2.- Servei d’autenticació amb certificat digital per usuaris que no estan a GICAR


										

									
								</h1>

								

								
								

								

								

							</div>
						</div>

					</div>
				</div>
			</article>

			


		   <div class="padding-xs container">
	    	
	    	   <i><b>Darrera actualització:</b></i> 18-08-2021
	        
           </div>
           
			<article class="padding-xs padding-sm padding-md contingut">				
				<div class="container">
 		
					
				

	


					

						

<p>GICAR ofereix també un servei per tal d’autenticar usuaris amb certificat digital (autenticació per a col·lectiu de ciutadania) independentment de que estiguin o no en el Directori Corporatiu de la Generalitat. Aquest servei és útil per a aplicacions que han de ser accedides per col·lectius d’usuaris que no poden ser identificats ni com a T1, T2, ni com a T3, i que per tant no tenen relació laboral amb la Generalitat.</p>

<p><img src="/related/gicar/autenticacio-anon-1.png" alt="Integració Aplicacions GICAR" /></p>

<p>Hi ha per tant la possibilitat d’indicar a GICAR que, per una aplicació en concret, permeti, amb certificat digital, l’accés a usuaris que no pertanyin al Directori Corporatiu de la Generalitat. Això s’aconsegueix protegint el recurs en qüestió amb l’esquema d’autenticació anònima.</p>

<h2 id="descripció-del-procés-d-autenticació-utilitzant-l-esquema-d-autenticació-anònima">Descripció del procés d’autenticació utilitzant l’esquema d’autenticació anònima.</h2>

<p>El procés que segueix GICAR per a autenticar usuaris és el que s’indica en el següent esquema:</p>

<p><img src="/related/gicar/diagrama-autenticacio-anonima.png" alt="Integració Aplicacions GICAR" /></p>

<p>A continuació es descriuen els passos que segueix GICAR en aquest esquema d’autenticació:</p>

<p>Si l’usuari no té cap sessió activa li apareixerà un formulari de login, per tal d’introduir les seves credencials, o autenticar-se amb certificat digital. En aquest punt, i tenint en compte l’esquema d’autenticació anònima hi ha tres opcions, que retornen la següent informació:</p>

<ol>
<li><p><strong>Autenticació amb usuari i contrasenya per usuaris que estan en el DC</strong>:</p>

<p>Aquesta opció només serà vàlida si l’usuari està donat d’alta en el Directori Corporatiu. SiteMinder validarà que les credencials introduïdes per l’usuari siguin les correctes en el DC, i, si això es compleix, retornarà la informació bàsica de l’usuari a l’aplicació a través de la capçalera HTTP_GICAR i HTTP_GICAR_ID. Exemples de les capçaleres</p>

<pre><code>HTTP_GICAR (conté les dades de l’usuari al DC) = “CODIINTERN=NRDRJN0001;NIF=11112222W;EMAIL=mail.admin@gencat.net;UNITAT_MAJOR=CTTI;UNITAT_MENOR=CTTI Qualitat”

HTTP_GICAR_ID (conté el NIF de l’usuari al DC) --&gt; 11112222W
</code></pre></li>

<li><p><strong>Autenticació amb certificat per usuaris que estan en el DC</strong>:</p>

<p>Aquesta casuística es dóna quan un usuari intenta accedir al recurs protegit per GICAR amb certificat digital, i aquest es troba en el Directori Corporatiu de la Generalitat. Les capçaleres que es rebran en aquest cas seran les següents:</p>

<pre><code>HTTP_GICAR (conté les dades de l’usuari al DC) = “CODIINTERN=NRDRJN0001;NIF=11112222W;EMAIL=mail.admin@gencat.net;UNITAT_MAJOR=CTTI;UNITAT_MENOR=CTTI Qualitat”

HTTP_GICAR_ID (conté el NIF de l’usuari) --&gt; 11112222W

De forma opcional i sota petició es podran sol·licitar les següents capçaleres:

HTTP_GICAR_CERT (conté el classification level, el issuer, el subject, i el OID del certificat)  --&gt; CLASIFICATIONLEVEL=4;CERTISSUER=C=ES, O=Agencia Catalana de Certificacio (NIF Q-0801176-I), L=Passatge de la Concepcio 11 08008 Barcelona, OU=Serveis Publics de Certificacio ECV-2, OU=Vegeu https://www.catcert.net/verCIC-2 (c)03, OU=Secretaria d'Administracio i Funcio Publica, CN=EC-SAFP;CERTSUBJECT=C=ES, O=Centre Telecomunicacions i Tecnologies de la Informació, OU=Serveis Públics de Certificació CPISR-1, OU=Vegeu https://www.catcert.cat/verCPISR-1 (c)03, SN=GARCIA GARCIA, G=ALBERT, SERIALNUMBER=46587898A, CN=CPISR-1 ALBERT GARCIA GARCIA;CERTIFICATEPOLICY=1.3.6.1.4.1.15096.1.3.1.81

HTTP_GICAR_PSIS: que contindrà la resposta de PSIS completa, i estarà enzipada i codificada en base64. Un cop descodificada i desenzipada s’obtindran les dades en la forma que s’especifica en l’apartat &quot;Descripció del procés per a obtenir la informació de la capçalera HTTP_GICAR_PSIS&quot; d'aquesta mateixa pàgina.
</code></pre>

<p>Cal destacar que la capçalera HTTP_GICAR_PSIS és la única capçalera indicada per a obtenir la informació de les diferents entitats de certificació que permet autenticar GICAR, o de nom i cognoms d’usuari autenticat, donat que és la única que conté les dades de forma estructurada.</p></li>

<li><p><strong>Autenticació amb certificat per usuaris que no estan en el DC (Autenticació Anònima)</strong>:</p>

<p>Aquesta casuística es dóna quan un usuari intenta accedir al recurs protegit per GICAR amb certificat digital, i aquest no pertany al Directori Corporatiu de la Generalitat. Les capçaleres que es rebran en aquest cas seran les següents:</p>

<pre><code>HTTP_GICAR_ID (conté el NIF de l’usuari) --&gt; 11112222W

HTTP_GICAR_CERT (conté el classification level, el issuer, el subject, i el OID del certificat)  --&gt; CLASIFICATIONLEVEL=4;CERTISSUER=C=ES, O=Agencia Catalana de Certificacio (NIF Q-0801176-I), L=Passatge de la Concepcio 11 08008 Barcelona, OU=Serveis Publics de Certificacio ECV-2, OU=Vegeu https://www.catcert.net/verCIC-2 (c)03, OU=Secretaria d'Administracio i Funcio Publica, CN=EC-SAFP;CERTSUBJECT=C=ES, O=Centre Telecomunicacions i Tecnologies de la Informació, OU=Serveis Públics de Certificació CPISR-1, OU=Vegeu https://www.catcert.cat/verCPISR-1 (c)03, SN=GARCIA GARCIA, G=ALBERT, SERIALNUMBER=46587898A, CN=CPISR-1 ALBERT GARCIA GARCIA;CERTIFICATEPOLICY=1.3.6.1.4.1.15096.1.3.1.81

HTTP_GICAR_PSIS: que contindrà la resposta de PSIS completa, i estarà enzipada i codificada en base64. Un cop descodificada i desenzipada s’obtindran les dades en la forma que s’especifica en l’annex D.
</code></pre>

<p>Cal destacar que la capçalera HTTP_GICAR_PSIS és la única capçalera indicada per a obtenir la informació de les diferents entitats de certificació que permet autenticar GICAR, o de nom i cognoms d’usuari autenticat, donat que és la única que conté les dades de forma estructurada.</p>

<p>En cas de voler obtenir el nom i cognoms de la persona que s’ha autenticat amb certificat, o altres dades del Certificat (excepte el DNI de l’usuari autenticat el qual es pot recuperar fàcilment amb la capçalera HTTP_GICAR_ID), es recomana fer-ho sempre amb la capçalera HTTP_GICAR_PSIS.</p></li>
</ol>

<h2 id="tipus-de-certificats-admesos-pel-servei-d-autenticació-anònima-de-gicar">Tipus de certificats admesos pel servei d’autenticació anònima de GICAR.</h2>

<p>El servei d’autenticació anònima de GICAR està preparat per a poder realitzar l’autenticació de qualsevol certificat reconegut per CatCert (Agència Catalana de Certificació). Actualment les següents entitats són reconegudes per CatCert:</p>

<ul>
<li><p>Agència Catalana de Certificació (CATCert)</p>

<ul>
<li>Entitat de certificació Secretaria d&rsquo;Administració i Funció Pública (EC-SAFP)</li>
<li>Entitat de certificació Administració Local (EC-AL)</li>
<li>Entitat de certificació Parlament (EC-PARLAMENT)<br /></li>
<li>Entitat de certificació Universitats i Recerca (EC-UR)</li>
<li>Entitat de certificació Universitat Rovira i Virgili (EC-URV)</li>
<li>Entitat de certificació idCAT (EC-idCAT)</li>
<li>Entitat de certificació Sector Públic (EC-SectorPublic)</li>
<li>Entitat de certificació Ciutadania (EC-Ciutadania)</li>
</ul></li>

<li><p>Autoridad de Certificación de la Abogacía (AC Abogacía)</p></li>

<li><p>Autoritat de Certificació de la Comunitat Valenciana (ACCV)</p></li>

<li><p>Agencia Notarial de Certificación (ANCert)</p></li>

<li><p>Asociación Nacional de Fabricantes - Autoridad de Certificación (ANF)</p></li>

<li><p>Camerfima - Certificados Camerales</p></li>

<li><p>Ceres Fábrica Nacional de Moneda y Timbre - Real Casa de la Moneda FNMT - RCM)</p></li>

<li><p>Direcció General de Policia (DNI-E)</p></li>

<li><p>Firmaprofesional</p></li>

<li><p>HealthSign</p></li>

<li><p>Intercambio Electrónico de Datos i Comunicaciones, SL (AC EDICOM)</p></li>

<li><p>Izenpe</p></li>

<li><p>Netfocus (no dóna serveis com a Prestador de Serveis de Certificació)</p></li>

<li><p>AC Organización Médica Colegial de España (OMC)</p></li>

<li><p>Servicio de Certificación de Registradores del Colegio de Registradores de la Propiedad y Mercantiles de España (SCR- CORPME)</p></li>
</ul>

<h2 id="descripció-del-procés-per-a-obtenir-la-informació-de-la-capçalera-http-gicar-psis">Descripció del procés per a obtenir la informació de la capçalera HTTP_GICAR_PSIS:</h2>

<p>La capçalera HTTP_GICAR_PSIS, si l&rsquo;usuari s&rsquo;ha autenticat amb certificat, contindrà la resposta de PSIS completa, i estarà enzipada i codificada en base64. Un cop descodificada i desenzipada la resposta tindrà la següent forma (en groc el nom dels atributs, i en blau el valor que prenen els mateixos:</p>

<pre><code>&lt;dss:VerifyResponse Profile=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS&quot; xmlns:dss=&quot;urn:oasis:names:tc:dss:1.0:core:schema&quot; xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
  &lt;dss:Result&gt;
    &lt;dss:ResultMajor&gt;urn:oasis:names:tc:dss:1.0:resultmajor:Success&lt;/dss:ResultMajor&gt;
    &lt;dss:ResultMinor&gt;urn:oasis:names:tc:dss:1.0:profiles:XSS:resultminor:valid:certificate:Definitive&lt;/dss:ResultMinor&gt;
  &lt;/dss:Result&gt;
  &lt;dss:OptionalOutputs&gt;
    &lt;dss:ProcessingDetails&gt;
      &lt;dss:ValidDetail Type=&quot;urn:oasis:names:tc:dss:1.0:detail:ValidityInterval&quot;&gt;
        &lt;dss:Message xml:lang=&quot;en&quot;&gt;The signing key is inside its static validity interval.&lt;/dss:Message&gt;
      &lt;/dss:ValidDetail&gt;
      &lt;dss:ValidDetail Type=&quot;urn:oasis:names:tc:dss:1.0:detail:IssuerTrust&quot;&gt;
        &lt;dss:Message xml:lang=&quot;en&quot;&gt;The issuer of the given key is trusted.&lt;/dss:Message&gt;
      &lt;/dss:ValidDetail&gt;
      &lt;dss:ValidDetail Type=&quot;urn:oasis:names:tc:dss:1.0:detail:RevocationStatus&quot;&gt;
        &lt;dss:Message xml:lang=&quot;en&quot;&gt;The signing key is not revoked.&lt;/dss:Message&gt;
      &lt;/dss:ValidDetail&gt;
    &lt;/dss:ProcessingDetails&gt;
    &lt;urn:X509CertificateInfo xmlns:urn=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS&quot;&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:Title&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Càrrec de prova&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:CertificatePolicies&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;1.3.6.1.4.1.15096.1.3.1.81.2.4&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:CertificateType&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Corporativo de persona física&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:ClassificationLevel&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:integer&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;4&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:IssuerDistinguishedName:commonName&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;EC-SAFP&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:Department&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Departament de prova&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:issuerCA&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;EC-SAFP&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:KeyOwnerNIF&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;00000000C&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:KeyUsages&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;digitalSignature,nonRepudiation&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:LegalEntityCIF&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Q0000000C&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:SubjectDistinguishedName:organizationName&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Organització de prova&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:professionalAssociations:ProfessionalAssociationInitials&quot;/&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:professionalAssociations:ProfessionalAssociationName&quot;/&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:professionalAssociations:ProfessionalAssociationNumber&quot;/&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:professionalAssociations:ProfessionalAssociationZone&quot;/&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:professionalAssociations:ProfessionalAssociationEmployeeNumber&quot;/&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:SerialNumber&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:integer&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;101517613294820238970587798414002567257&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:SubjectDistinguishedName:commonName&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;CPISR-1 C Persona Física de la Peça de Proves&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:SubjectDistinguishedName:givenName&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Persona Física&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:SubjectDistinguishedName:surname&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;de la Peça de Proves&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:SubjectDistinguishedName:title&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Càrrec de prova&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:SubjectEmail&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;correue@catcert.cat&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:SubjectPublicKeyAlgorithm&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;RSA&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:oasis:names:tc:dss:1.0:profiles:XSS:certificateAttributes:Version&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:integer&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;3&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:VinculatedCompanyCIF&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Q0000000C&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:VinculatedCompanyName&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Organització de prova&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:VinculatedPersonFullName&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;CPISR-1 C Persona Física de la Peça de Proves&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:VinculatedPersonName&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;Persona Física&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:VinculatedPersonNIForNIE&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;00000000C&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
      &lt;urn:Attribute Name=&quot;urn:catcert:psis:certificateAttributes:VinculatedPersonSurname&quot;&gt;
        &lt;urn1:AttributeValue xsi:type=&quot;xs:string&quot;  xmlns:urn1=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; &gt;de la Peça de Proves&lt;/urn1:AttributeValue&gt;
      &lt;/urn:Attribute&gt;
    &lt;/urn:X509CertificateInfo&gt;
  &lt;/dss:OptionalOutputs&gt;
&lt;/dss:VerifyResponse&gt;
</code></pre>

<p>A continuació, a la següent taula es detalla el sentit de cada atribut:</p>

<pre><code>Title: Càrrec de la persona dins de l’organització
CertificatePolicies: OID del certificat
CertificateType: Tipologia de certificat
ClassificationLevel: Nivell de classificació de seguretat del certificat
IssuerDistinguishedName: Tipus de certificat dins de la CA
VinculatedCompanyCIF: CIF de l’empresa a la que pertany l’usuari
Department: Departament o organització a la qual pertany l’usuari
KeyOwnerNIF: NIF del propietari del certificat
KeyUsages: Utilització que se li pot donar al certificat
SerialNumber: Número de serie del certificat
commonName: Common Name del certificat
givenName: Nom de l’usuari propietari del certificat
surname: Cognoms
SubjectEmail: Mail de l’usuari propietari del certificat
SubjectPublicKeyAlgorithm: Algorisme de xifrat del certificat
Version: Versió certificat
</code></pre>

<p>Per últim, es copia a continuació un fragment de codi en llenguatge Java que mostra el procediment per accedir a la capçalera HTTP_GICAR_PSIS:</p>

<pre><code>import java.io.*;
import java.util.zip.*;
import sun.misc.BASE64Decoder;
import javax.servlet.http.*;

HttpServletRequest httpRequest = /*Objecte request amb la petició autenticada*/

/*Obtenim la capçalera HTTP_GICAR_PSIS del “request”*/
String headerPSIS = httpRequest.getHeader(“HTTP_GICAR_PSIS”);


BASE64Decoder decoder = new BASE64Decoder();
/*Decodifiquem la capçalera en base 64 per obtenir el byte[ ] amb el zip que conté la resposta de PSIS*/
byte[] psisZip = decoder.decodeBuffer(headerPSIS);

/*Obtenim un ZipInputStream a partir del byte[ ]*/
InputStream bIn = new ByteArrayInputStream(psisZip);
ZipInputStream zipIn = new ZipInputStream(bIn);

/*Agafem la primera entrada del ZIP, només hi ha una*/
ZipEntry zipEntry = zipIn.getNextEntry();

/*Fem servir el buffer “bOut” per guardar el xml desenzipat*/
ByteArrayOutputStream bOut = new ByteArrayOutputStream();

int nRead;
byte[] data = new byte[1024];

/*Obtenim el contingut del zip i el copiem al buffer en blocs de 1024 bits*/
while ((nRead = zipIn.read(data, 0, data.length)) != -1) {
  bOut.write(data, 0, nRead);
}

bOut.flush();

/*En aquest punt tenim al buffer “bOut” el contingut xml de la resposta PSIS */
</code></pre>


					

					
				</div>	

			</article>	


	</section>	

		<div class="fons_footer ">
		<footer class="container center-block shadowBox2">
			<div class="shadow2"></div>
			<div class="row footer_tab_ord">

				<div class="footer_tab_bot col-sm-12">
					<div class="avis_legal">

						<div id="fAvisLegal">
							<div>
								<div class="hidden-xs">
									<a href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" alt="www.gencat.cat"
										/></a>
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								<div class="visible-xs avis_legal">
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								
								<div class="fi_peu visible-xs">
									<a title="www.gencat.cat" href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" 
										alt="www.gencat.cat" /></a> <a class="torna_amunt pull-right"
										href=" javascript:tornarAmunt();" title="Torna amunt">
										<p>Torna amunt</p>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</footer>
	</div>

<script src="/js/master.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
<script src="/js/custom.js" type="text/javascript"></script>



<script type="text/javascript">

if(location.hostname!=="localhost"){

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', "UA-59408075-1", 'auto');
	ga('send', 'pageview', {
	  	'page': location.pathname + location.search  + location.hash
	  }
	);

}

</script>




</body>
</html>
