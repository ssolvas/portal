<!DOCTYPE html>
<html xml:lang="ca-ES" lang="ca-ES" xmlns="http://www.w3.org/1999/xhtml">
<head>

	<title>GECAT</title>
		<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
	<link href="/css/master.min.css" rel="stylesheet" type="text/css" />
	<link href="/css/canigo.css" rel="stylesheet" type="text/css" />
	<script src="/js/jquery.min.js" type="text/javascript"></script>

	<script>
		document.write("<meta name=\"titol\" content=\"GECAT\" />");
		document.write("<meta name=\"description\" content=\"Utilització del connector al sistema SAP del Gecat\" />");
	</script>

	

</head>
<body class="single">
	<div class="contenidor unfixed">

				

		<header class="fons_header navbar navbar-default z-index-menu">
			<div class="container" role="menu">
				<div class="row clearfix menuNav">
					<div class="col-md-3 col-xs-3 column visible-xs coloca ">
						<button type="button" onclick="amunt();" title="Menu"
							class="navbar-toggle pull-left" data-toggle="collapse"
							data-target=".navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span
								class="icon-bar"></span> <span class="icon-bar"></span> <span
								class="icon-bar"></span>
						</button>
					</div>

					<div class="col-md-3 col-xs-6 col-offset-2 column visible-xs titol-mobil">
						
						<span class="white titol-mobil-destacat">canigo.ctti</span><span class="white">.gencat.cat</span>
					</div>

					<div class="col-md-3 col-xs-3 column visible-xs coloca1">
						<button onclick="amunt();" type="button" title="Cerca"
							class="ico_cerca " data-toggle="collapse" data-target=".dos">
						</button>
					</div>

				</div>

				<div class="collapse dos">
					<div class="shadowBox">
						<form class="navbar-form navbar-left primer" action="/cercador/" method="get"
 						onsubmit="location.href=this.action+'?q='+this.cerca_cap.value; return false;">
							<div class="form-group">
								<input type="search" class="form-control" name="q" id="cerca_cap"
									title="Cerca"
									placeholder="Cerca" />
								<button type="button" title="Neteja" class="btn btn-default"></button>
								<input type="submit" class="ocult" name="Cerca" value="Cerca" />
							</div>
						</form>
					</div>
				</div>	

				<nav class="collapse navbar-collapse navbar-ex1-collapse ">
				
					<div class="row">
						<div class="col-md-6 col-sm-4 column">
							<a class="img-responsive logo" title="Generalitat de Catalunya"
								href="https://ctti.gencat.cat/">gencat.cat</a>
							<button class="menu_tancar visible-xs collapsed"
								data-target=".navbar-collapse" data-toggle="collapse"
								title="Tancar"></button>
						</div>

						<div class="col-md-6 col-sm-8 column hidden-xs hidden-mg">
							<form class="navbar-form cercador_vermell hidden-xs pull-right" action="/cercador/"  method="get" onsubmit="location.href=this.action+'?q='+this.cerca2.value; return false;">
								<div class="form-group">
									<label class="hidden" for="cerca2">Cerca</label>
									<input id="cerca2" class="form-control" type="search" 
									placeholder="Cerca" name="q" title="Cerca">
									<input class="btn btn-default" type="submit" title="Cerca" value="">
								</div>
							</form>

							

						</div>

					</div>
					<div class="col-xs-12 hidden-xs" id="nomPortal">
                    	<span class="titol-cap-nou">Centre de Telecomunicacions i Tecnologies de la Informació</span>
                    </div>					
					<ul class="nav navbar-nav">

			        	

						<li>
							<a class="dropdown-toggle" href='/' data-toggle='_dropdown'>Inici</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/arqctti' data-toggle='_dropdown'>Arquitectura CTTI</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/blog' data-toggle='_dropdown'>Blog</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cloud' data-toggle='_dropdown'>Cloud</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/canigo' data-toggle='_dropdown'>Canigó</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sic' data-toggle='_dropdown'>SIC</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sgde' data-toggle='_dropdown'>SGDE</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/gicar' data-toggle='_dropdown'>GICAR</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cs' data-toggle='_dropdown'>Centres de Suport</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/dadesref' data-toggle='_dropdown'>Gestió Tècnica de Dades</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/eventhub' data-toggle='_dropdown'>EventHub</a>
						</li>

						

					</ul>

				</nav>
			</div>
		</header>



	</div>

	<section class="border-start">

						
			

			<article class="bgGrey">
				<div class="container">
					<div class="row">
						<div class="capcelera_basica col-sm-12">
							<div class="capcelera_basica_cont">
								<ol class="breadcrumb filariana hidden-xs">
									<li>
										<a href="/">Inici</a>
									</li>
									<li class="breadcrumbs2">
									
										<a href="/canigo-fwk-docs">
											




























	
	
	
	
	
	  
	  
	
	  
	  
	  	
	  	
	  	<a href='https://canigo.ctti.gencat.cat/canigo-fwk-docs/'>canigo fwk docs</a>
	  	
	  
	
	  
	  
	  	
	  	
	  		<li>
	  	
	  	<a href='https://canigo.ctti.gencat.cat/canigo-fwk-docs/documentacio-per-versions/'>documentacio per versions</a>
	  	
	  		</li>
	  	
	  
	
	  
	  
	  	
	  	
	  		<li>
	  	
	  	<a href='https://canigo.ctti.gencat.cat/canigo-fwk-docs/documentacio-per-versions/3.4LTS/'>3.4LTS</a>
	  	
	  		</li>
	  	
	  
	
	  
	  
	  	
	  	
	  		<li>
	  	
	  	<a href='https://canigo.ctti.gencat.cat/canigo-fwk-docs/documentacio-per-versions/3.4LTS/3.4.9/'>3.4.9</a>
	  	
	  		</li>
	  	
	  
	
	  
	  
	  	
	  	
	  		<li>
	  	
	  	<a href='https://canigo.ctti.gencat.cat/canigo-fwk-docs/documentacio-per-versions/3.4LTS/3.4.9/moduls/'>moduls</a>
	  	
	  		</li>
	  	
	  
	
	  
	  
	  	
	  	
	  		<li>
	  	
	  	<a href='https://canigo.ctti.gencat.cat/canigo-fwk-docs/documentacio-per-versions/3.4LTS/3.4.9/moduls/moduls-integracio/'>moduls integracio</a>
	  	
	  		</li>
	  	
	  
	
	  
	  
	  	
	  	
	  		<li>
	  	
	  	<a href='https://canigo.ctti.gencat.cat/canigo-fwk-docs/documentacio-per-versions/3.4LTS/3.4.9/moduls/moduls-integracio/modul-gecat/'>modul gecat</a>
	  	
	  		</li>
	  	
	  
	
	  
	  
	


										</a>
										




























































































									
									</li>

								</ol>

								<h1 class="capcelera_flotant pull-left" data-txt=".title">
									

										
											




	GECAT


										

									
								</h1>

								

								
								

								

								

							</div>
						</div>

					</div>
				</div>
			</article>

			


		   <div class="padding-xs container">
	    	
	    	   <i><b>Darrera actualització:</b></i> 27-12-2021
	        
           </div>
           
			<article class="padding-xs padding-sm padding-md contingut">				
				<div class="container">
 		
					
				

	


					

						

<div class="message warning">

A partir de la publicació de Canigó 3.4.3 el 26/03/2020 aquest mòdul quedarà deprecat, per lo que no es preveu seguir evolucionant aquest mòdul.

</div>

<h2 id="propòsit">Propòsit</h2>

<p>L&rsquo;objectiu d’aquest article és <strong>descriure la metodologia a seguir en la utilització del connector al sistema SAP de Gecat des de qualsevol aplicació Java del Framework J2EE</strong>.
L&rsquo;abast d&rsquo;aquest connector es fonamenta en la utilització de les funcions d&rsquo;alta de factures, consultes i reserves online del SAP de Gecat, així com totes les funcions batch.
El connector permet l&rsquo;accés al SAP mitjançant objectes de consulta, transformant aquests objectes en una cadena de caràcters vàlida per al SAP. La cadena de retorn és transformada
novament en un objecte que conté els registres de retorn.</p>

<h2 id="instal-lació">Instal·lació</h2>

<p>Per a poder utilitzar el connector haurem de configurar el projecte per a que inclogui unes <strong>llibreries DLL i diferents llibreries Java</strong>:</p>

<ul>
<li><p>Les llibreries DLL són: <em>sapjcorfc.dll</em> i <em>librfc32.dll</em>, s&rsquo;hauran de copiar al directori <code>system32</code>.</p></li>

<li><p>Per a fer les operacions sobre el sistema SAP del Gecat és necessària la utilització de la llibreria <em>sapjco-2.1.6.jar</em>, que és el connector propi del SAP per a fer les crides a les seves funcions BAPI (RFC).</p></li>

<li><p>Les classes que utilitzarem per a construïr els objectes d&rsquo;operacions estan disponibles a la llibreria del connector Gecat09 <em>canigo-connectors-gecat09-2.3.2.jar</em>.</p></li>
</ul>

<p>Les classes que utilitzarem per a fer les operacions han estat generades amb una eina Open Source anomenada JAXB (Java API for Xml Binding) que s’encarrega de
generar les classes Java a partir d&rsquo;un esquema de Xml (<em>XMLSchema</em>). Aquesta eina ens permet no solament generar automàticament classes sinó també fer validacions
per a comprovar que les dades que contenen els objectes siguin vàlides. Serà necessari, per tant, incloure també:</p>

<ul>
<li>jaxb-api-1.0.1.jar</li>
<li>jaxb-libs-1.0.6.jar</li>
<li>jaxb-impl-1.0.5.jar</li>
<li>jax-qname-1.1.jar</li>
<li>namespace-1.0.1.jar</li>
<li>relaxngDatatype-20020414.jar</li>
<li>xsdlib-2013.6.1.jar</li>
</ul>

<p>Per tal d&rsquo;instal·lar el Mòdul de Gecat es pot optar per incloure’l automàticament a través de l&rsquo;eina de suport al desenvolupament o bé afegir
manualment la següent dependència en el fitxer <code>pom.xml</code> de l’aplicació:</p>

<pre><code>&lt;canigo.integration.gecat.version&gt;[1.2.0,1.3.0)&lt;/canigo.integration.gecat.version&gt;

&lt;dependency&gt;
          &lt;groupId&gt;cat.gencat.ctti&lt;/groupId&gt;
          &lt;artifactId&gt;canigo.integration.gecat&lt;/artifactId&gt;
          &lt;version&gt;${canigo.integration.gecat.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h2 id="configuració">Configuració</h2>

<p>La configuració es realitza automàticament a partir de l&rsquo;eina de suport al desenvolupament.
El fitxer de configuració es troba a: <code>&lt;PROJECT_ROOT&gt;/src/main/resources/config/props/sap.properties</code>.</p>

<table>
<thead>
<tr>
<th>Propietat</th>
<th>Requerit</th>
<th>Descripció</th>
</tr>
</thead>

<tbody>
<tr>
<td>*.sap.client</td>
<td>Sí</td>
<td>Client</td>
</tr>

<tr>
<td>*.sap.username</td>
<td>Sí</td>
<td>Usuari de connexió</td>
</tr>

<tr>
<td>*.sap.password</td>
<td>Sí</td>
<td>Password de connexió</td>
</tr>

<tr>
<td>*.sap.language</td>
<td>Sí</td>
<td>Idioma</td>
</tr>

<tr>
<td>*.sap.hostname</td>
<td>Sí</td>
<td>Nom del servidor</td>
</tr>

<tr>
<td>*.sap.systemNumber</td>
<td>Sí</td>
<td>SAP system number</td>
</tr>

<tr>
<td>*.sap.connectionPool</td>
<td>No</td>
<td>Connexió amb pool. Per defecte: true</td>
</tr>

<tr>
<td>*.sap.connectionPoolName</td>
<td>No</td>
<td>Nom del pool. Per defecte: poolCanigoSAP</td>
</tr>

<tr>
<td>*.sap.maxNumConnections</td>
<td>No</td>
<td>Número de connexions màximes. Per defecte: 5</td>
</tr>

<tr>
<td>*.sap.repositoryName</td>
<td>No</td>
<td>Nom del repository. Per defecte: ARAsoft</td>
</tr>
</tbody>
</table>

<h2 id="funcionament">Funcionament</h2>

<p>La utilització del connector es fonamenta en la seva <strong>configuració prèvia i en la invocació des dels clients mitjançant les interfícies definides</strong>.
El connector del Gecat ofereix tres operacions: alta de factures online, consultes i reserves.
Cada operació té associada una classe que conté tota la informació de l&rsquo;operació (o crida) i un altra amb la informació de resposta.
Les operacions poden incloure una sola línia o diverses.</p>

<p>Per exemple, si tenim l&rsquo;operació <em>consultaFactura</em> (que conté una sola línia <em>dadesConsulta</em>) haurem de crear un objecte de la classe <em>DadesConsultaFacturaType</em> i
un altre de <em>DadesConsultaType</em>. Aquest últim l&rsquo;omplirem amb totes les dades necessàries mitjançant els seus mètodes d’assignació: <em>setSocietat</em>, <em>setCodiCreditor</em>, etcètera. Un cop emplenada la informació d’aquest objecte (que representa una sola línia) l&rsquo;afegirem
a l&rsquo;altre, que és el que representa tota la consulta, mitjançant també un mètode d’assignació <em>dadesConsultaFactura.setDadesConsulta()</em>.
Un cop hem creat l&rsquo;objecte de crida amb totes les dades necessàries, utilitzarem un objecte de la classe <em>GecatConnector</em> per a obtenir l&rsquo;objecte de sortida amb les dades retornades pel SAP.</p>

<h3 id="rest">REST</h3>

<p>Per a utilitzar aquest mòdul, cal crear un <em>Service</em> i un <em>Controller</em>.</p>

<p><br/></p>

<h4 id="service-gecatservice-java">Service (GecatService.java)</h4>

<p>Aquesta classe és en la que s&rsquo;implementarà la lògica de l’operació a realitzar i es connectarà amb el mòdul de notificacions electròniques.</p>

<pre><code class="language-java">import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Lazy;
import org.springframework.stereotype.Service;

import cat.gencat.ctti.canigo.arch.integration.gecat.connector.GecatConnector;
import cat.gencat.ctti.canigo.arch.integration.gecat.consultes.ConsultaTerritori.DadesConsultaTerritoriType;
import cat.gencat.ctti.canigo.arch.integration.gecat.consultes.ConsultaTerritori.DadesConsultaType;
import cat.gencat.ctti.canigo.arch.integration.gecat.consultes.ConsultaTerritori.ObjectFactory;
import cat.gencat.ctti.canigo.arch.integration.gecat.consultes.ConsultaTerritoriRetorn.DadesConsultaTerritoriRetornType;

@Service(&quot;gecatService&quot;)
@Lazy
public class GecatService {

   private static final Logger log = LoggerFactory.getLogger(GecatService.class);

   @Autowired
   private GecatConnector gecatConnector;

   public String testGecat(){
      String message;
      try {

        ObjectFactory objectFactory = new ObjectFactory();

        /**
         * creem l'objecte per fer la consulta
         **/
        DadesConsultaTerritoriType dadesConsultaTerritori = objectFactory.createDadesConsultaTerritoriType();
        DadesConsultaType dadesConsulta = objectFactory.createDadesConsultaType();
        dadesConsulta.setCodiTerritori(&quot;0217188&quot;);
        dadesConsultaTerritori.setDadesConsulta(dadesConsulta);
        DadesConsultaTerritoriRetornType dadesConsultaRetorn = gecatConnector.consultaTerritori(dadesConsultaTerritori);

        log.info(&quot;getCodiTerritori():&quot; +
                dadesConsultaRetorn.getDadesRetorn().getCodiTerritori());
        log.info(&quot;getNomTerritori():&quot; +
                dadesConsultaRetorn.getDadesRetorn().getNomTerritori());

        message = &quot;Resultat test : &quot; + dadesConsultaRetorn.getDadesRetorn().getNomTerritori();
      }
      catch (Exception e) {
         message = &quot;Error al test : &quot; + e.getMessage();
         log.error(e.getMessage(),e);
      }
      return message;
    }

}
</code></pre>

<p><br/></p>

<h4 id="controller-gecatservicecontroller-java">Controller (GecatServiceController.java)</h4>

<p>Controlador que publica les operacions disponibles per a que es puguin consumir.</p>

<pre><code class="language-java">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import cat.gencat.plantilla32.service.GecatService;

@RestController
@RequestMapping(&quot;/gecat&quot;)
public class GecatServiceController {

   @Autowired
   GecatService;

   @PostMapping(produces = { MediaType.APPLICATION_JSON_VALUE })
   public String testGecat() throws Exception {
      return gecatService.testGecat();
   }
}
</code></pre>

<h3 id="exemples">Exemples</h3>

<p><br/></p>

<h4 id="crides-a-gecat-sense-línies-repetides">Crides a Gecat sense línies repetides</h4>

<h5 id="retorn-sense-línies-repetides">Retorn sense línies repetides</h5>

<p>Per a mostrar aquest tipus de crida agafarem com a exemple la <strong>consulta de partida</strong>.
Primerament caldrà crear un objecte de la classe <em>ObjectFactory</em> que, com el seu nom indica, és una classe per a crear
objectes d&rsquo;altres classes. Aquestes classes són les que ofereix JAXB per a crear objectes amb una certa estructura predefinida.</p>

<pre><code class="language-java">cat.gencat.ctti.canigo.arch.integration.gecat.consultes.ConsultaPartidaPressupostaria.ObjectFactory objectFactory = new cat.gencat.ctti.canigo.arch.integration.gecat.consultes.ConsultaPartidaPressupostaria.ObjectFactory();
</code></pre>

<p>Seguidament crearem un objecte de la classe <em>DadesConsultaPartidaPressupostariaType</em> que representarà la crida completa.
Aquest objecte contindrà un objecte de la classe <em>DadesConsultaType</em> per a cada una de les línies amb tota la informació necessària.</p>

<pre><code class="language-java">DadesConsultaPartidaPressupostariaType dadesConsultaPartidaPressupostaria = objectFactory.createDadesConsultaPartidaPressupostariaType();
DadesConsultaType dadesConsulta = objectFactory.createDadesConsultaType();
dadesConsulta.setCentreGestor(&quot;1006&quot;);
dadesConsulta.setEntitatCP(&quot;1000&quot;);
dadesConsulta.setExercici(&quot;2002&quot;);
dadesConsulta.setPosicioPressupostaria(&quot;D/220100100/4551&quot;);
dadesConsulta.setVinculacio(&quot;S&quot;);
dadesConsultaPartidaPressupostaria.setDadesConsulta(dadesConsulta);
</code></pre>

<p>Ja podrem fer la crida al SAP mitjançant el mètode <em>consultaPartidaPressupostaria</em> de la classe <em>GecatConnector</em> passant-li l’objecte de consulta.</p>

<pre><code class="language-java">DadesConsultaPartidaPressupostariaRetornType dadesConsultaRetorn = gecatConnector.consultaPartidaPressupostaria(dadesConsultaPartidaPressupostaria);
</code></pre>

<p>En aquest punt ja es disposa de l’objecte de retorn llest per a ser utilitzat per l&rsquo;aplicació.</p>

<pre><code class="language-java">System.out.println(&quot;getDenominacio():&quot; + dadesConsultaRetorn.getDadesRetorn().getDenominacio());
</code></pre>

<h5 id="retorn-amb-línies-repetides">Retorn amb línies repetides</h5>

<p>Per a mostrar aquest tipus de crida agafarem com exemple la <strong>consulta de creditor</strong>.
Primerament caldrà crear un objecte de la classe <em>ObjectFactory</em> que, com el seu nom indica, és una classe per a crear objectes d&rsquo;altres classes.
Aquestes classes són les que ofereix JAXB per a crear objectes amb una certa estructura predefinida.</p>

<pre><code class="language-java">net.gencat.gecat.consultes.ConsultaCreditor.ObjectFactory objectFactory = new net.gencat.gecat.consultes.ConsultaCreditor.ObjectFactory();
</code></pre>

<p>Seguidament crearem un objecte de la classe <em>DadesConsultaCreditorType</em> que representarà la crida completa.
Aquest objecte contindrà un objecte de la classe <em>DadesConsultaType</em> per a cada una de les línies amb tota la informació necessària.</p>

<pre><code class="language-java">DadesConsultaCreditorType dadesConsultaCreditor = objectFactory.createDadesConsultaCreditorType();
DadesConsultaType dadesConsulta = objectFactory.createDadesConsultaType();
dadesConsulta.setNIFoCodiCreditor(&quot;A53062927&quot;);
dadesConsulta.setRegistreInicial(&quot;001&quot;);
dadesConsulta.setSocietat(&quot;1000&quot;);
dadesConsultaCreditor.setDadesConsulta(dadesConsulta);
</code></pre>

<p>Ja podrem fer la crida al SAP mitjançant el mètode <em>consultaCreditor</em> de la classe <em>GecatConnector</em> passant-li l’objecte de consulta.</p>

<pre><code class="language-java">DadesConsultaCreditorRetornType dadesConsultaRetorn = gecatConnector.consultaCreditor(dadesConsultaCreditor);
</code></pre>

<p>En aquest punt ja es disposa de l’objecte de retorn llest per a ser utilitzat per l&rsquo;aplicació.</p>

<pre><code class="language-java">List finalList = dadesConsultaRetorn.getDadesRetorn().getDadaRetorn();
System.out.println(&quot;dadaRetorn.getAdreca:&quot; + ((DadaRetornType)finalList.get(0)).getAdreca());
</code></pre>

<p><br/></p>

<h4 id="crides-a-gecat-amb-línies-repetides">Crides a Gecat amb línies repetides</h4>

<p>Per a mostrar aquest tipus de crida agafarem com a exemple la <strong>consulta de factures d’habilitats</strong>.
Primerament caldrà crear un objecte de la classe <em>ObjectFactory</em> que, com el seu nom indica, és una classe per a crear objectes d&rsquo;altres classes.
Aquestes classes són les que ofereix JAXB per a crear objectes amb una certa estructura predefinida.</p>

<pre><code class="language-java">cat.gencat.ctti.canigo.arch.integration.gecat.factures.FacturesHabilitatsOnline.ObjectFactory objectFactory = new cat.gencat.ctti.canigo.arch.integration.gecat.factures.FacturesHabilitatsOnline.ObjectFactory();
</code></pre>

<p>Seguidament crearem un objecte de la classe <em>DadesAltaFacturesHabilitatsOnlineType</em> que representarà la crida completa.
Aquest objecte contindrà un objecte de la classe <em>DadesGeneralsFacturaType</em>
per a cada una de les línies amb tota la informació necessària.</p>

<pre><code class="language-java">DadesAltaFacturesHabilitatsOnlineType dadesAltaFacturaHabilitats = objectFactory.createDadesAltaFacturesHabilitatsOnlineType();
DadesGeneralsFacturaType dadesGeneralsFactura = objectFactory.createDadesGeneralsFacturaType();
dadesGeneralsFactura.setDataCompt(&quot;24051980&quot;);
dadesGeneralsFactura.setDataDocument(&quot;01&quot;);
...
dadesGeneralsFactura.setTransaccio(&quot;ZD21&quot;);
dadesAltaFacturaHabilitats.setDadesGeneralsFactura(dadesGeneralsFactura);
</code></pre>

<p>Si la línia pot estar repetida, com en el cas de les retencions aplicades, haurem de crear una llista d&rsquo;objectes de la classe <em>RetencionsHabilitatSubhabilitatType</em>.</p>

<pre><code class="language-java">RetencionsHabilitatSubhabilitatType retencionsHS = objectFactory.1createRetencionsHabilitatSubhabilitatType();
List retencionsHSList = retencionsHS.getRetencioHabilitatSubhabilitat();
RetencioHabilitatSubhabilitatType retencioHS = objectFactory.
createRetencionsHabilitatSubhabilitatTypeRetencioHabilitatSubhabilitatType();

retencioHS.setImportBase(&quot;1500&quot;);
retencioHS.setImportRetencio(&quot;25000&quot;);
retencioHS.setIndicadorRetencio(&quot;01&quot;);
retencioHS.setTipusRegistre(&quot;3&quot;);
retencioHS.setOrder(0);
retencionsHSList.add(retencioHS);

retencioHS = (RetencioHabilitatSubhabilitatType)retencioHS.getClass().newInstance();
retencioHS.setImportBase(&quot;1600&quot;);
retencioHS.setImportRetencio(&quot;26000&quot;);
retencioHS.setIndicadorRetencio(&quot;01&quot;);
retencioHS.setTipusRegistre(&quot;3&quot;);
retencioHS.setOrder(1);
retencionsHSList.add(retencioHS);

dadesAltaFacturaHabilitats.setRetencionsHabilitatSubhabilitat(retencionsHS);
</code></pre>

<p>Fixem-nos que és important donar un ordre a les línies contingudes en la llista:</p>

<pre><code class="language-java">retencioHS.setOrder(0);
</code></pre>

<p>Ja podrem fer la crida al SAP mitjançant el mètode <em>altaFacturesHabilitats</em> de la classe <em>GecatConnector</em> passant-li l’objecte d’alta.</p>

<pre><code class="language-java">DadesConsultaCreditorRetornType dadesConsultaRetorn = gecatConnector.consultaCreditor(dadesConsultaCreditor);
</code></pre>

<p>En aquest punt ja es disposa de l’objecte de retorn llest per a ser utilitzat per l&rsquo;aplicació.</p>

<pre><code class="language-java">List finalList = dadesAltaFacturaRetorn.getDadesRetorn().getDadaRetorn();
System.out.println(&quot;dadaRetorn.getClasseDocument():&quot; +
((DadaRetornType)finalList.get(0)).getClasseDocument());
</code></pre>

<h3 id="entorn-de-proves">Entorn de proves</h3>

<p>S&rsquo;han habilitat dos usuaris per a fer proves amb el connector de Gecat i poden ser utilitzats per als desenvolupadors de cara a fer proves:</p>

<ul>
<li>ZBTCCANIGO per a les interfícies &ldquo;batch&rdquo;</li>
<li>ZINTCANIGO per a les interfícies &ldquo;online&rdquo;</li>
</ul>

<p>No obstant, <strong>en cap cas es podran utilitzar en entorns productius</strong>.</p>


					

					
				</div>	

			</article>	


	</section>	

		<div class="fons_footer ">
		<footer class="container center-block shadowBox2">
			<div class="shadow2"></div>
			<div class="row footer_tab_ord">

				<div class="footer_tab_bot col-sm-12">
					<div class="avis_legal">

						<div id="fAvisLegal">
							<div>
								<div class="hidden-xs">
									<a href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" alt="www.gencat.cat"
										/></a>
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								<div class="visible-xs avis_legal">
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								
								<div class="fi_peu visible-xs">
									<a title="www.gencat.cat" href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" 
										alt="www.gencat.cat" /></a> <a class="torna_amunt pull-right"
										href=" javascript:tornarAmunt();" title="Torna amunt">
										<p>Torna amunt</p>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</footer>
	</div>

<script src="/js/master.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
<script src="/js/custom.js" type="text/javascript"></script>



<script type="text/javascript">

if(location.hostname!=="localhost"){

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', "UA-59408075-1", 'auto');
	ga('send', 'pageview', {
	  	'page': location.pathname + location.search  + location.hash
	  }
	);

}

</script>




</body>
</html>
