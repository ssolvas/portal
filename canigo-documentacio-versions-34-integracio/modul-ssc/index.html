<!DOCTYPE html>
<html xml:lang="ca-ES" lang="ca-ES" xmlns="http://www.w3.org/1999/xhtml">
<head>

	<title>Servei de Signatura Centralitzada - SSC</title>
		<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
	<link href="/css/master.min.css" rel="stylesheet" type="text/css" />
	<link href="/css/canigo.css" rel="stylesheet" type="text/css" />
	<script src="/js/jquery.min.js" type="text/javascript"></script>

	<script>
		document.write("<meta name=\"titol\" content=\"Servei de Signatura Centralitzada - SSC\" />");
		document.write("<meta name=\"description\" content=\"Serveis d\x27accés al Sistema de Signatura Centralitzada de Catcert.\" />");
	</script>

	

</head>
<body class="single">
	<div class="contenidor unfixed">

				

		<header class="fons_header navbar navbar-default z-index-menu">
			<div class="container" role="menu">
				<div class="row clearfix menuNav">
					<div class="col-md-3 col-xs-3 column visible-xs coloca ">
						<button type="button" onclick="amunt();" title="Menu"
							class="navbar-toggle pull-left" data-toggle="collapse"
							data-target=".navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span
								class="icon-bar"></span> <span class="icon-bar"></span> <span
								class="icon-bar"></span>
						</button>
					</div>

					<div class="col-md-3 col-xs-6 col-offset-2 column visible-xs titol-mobil">
						
						<span class="white titol-mobil-destacat">canigo.ctti</span><span class="white">.gencat.cat</span>
					</div>

					<div class="col-md-3 col-xs-3 column visible-xs coloca1">
						<button onclick="amunt();" type="button" title="Cerca"
							class="ico_cerca " data-toggle="collapse" data-target=".dos">
						</button>
					</div>

				</div>

				<div class="collapse dos">
					<div class="shadowBox">
						<form class="navbar-form navbar-left primer" action="/cercador/" method="get"
 						onsubmit="location.href=this.action+'?q='+this.cerca_cap.value; return false;">
							<div class="form-group">
								<input type="search" class="form-control" name="q" id="cerca_cap"
									title="Cerca"
									placeholder="Cerca" />
								<button type="button" title="Neteja" class="btn btn-default"></button>
								<input type="submit" class="ocult" name="Cerca" value="Cerca" />
							</div>
						</form>
					</div>
				</div>	

				<nav class="collapse navbar-collapse navbar-ex1-collapse ">
				
					<div class="row">
						<div class="col-md-6 col-sm-4 column">
							<a class="img-responsive logo" title="Generalitat de Catalunya"
								href="https://ctti.gencat.cat/">gencat.cat</a>
							<button class="menu_tancar visible-xs collapsed"
								data-target=".navbar-collapse" data-toggle="collapse"
								title="Tancar"></button>
						</div>

						<div class="col-md-6 col-sm-8 column hidden-xs hidden-mg">
							<form class="navbar-form cercador_vermell hidden-xs pull-right" action="/cercador/"  method="get" onsubmit="location.href=this.action+'?q='+this.cerca2.value; return false;">
								<div class="form-group">
									<label class="hidden" for="cerca2">Cerca</label>
									<input id="cerca2" class="form-control" type="search" 
									placeholder="Cerca" name="q" title="Cerca">
									<input class="btn btn-default" type="submit" title="Cerca" value="">
								</div>
							</form>

							

						</div>

					</div>
					<div class="col-xs-12 hidden-xs" id="nomPortal">
                    	<span class="titol-cap-nou">Centre de Telecomunicacions i Tecnologies de la Informació</span>
                    </div>					
					<ul class="nav navbar-nav">

			        	

						<li>
							<a class="dropdown-toggle" href='/' data-toggle='_dropdown'>Inici</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/arqctti' data-toggle='_dropdown'>Arquitectura CTTI</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/blog' data-toggle='_dropdown'>Blog</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cloud' data-toggle='_dropdown'>Cloud</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/canigo' data-toggle='_dropdown'>Canigó</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sic' data-toggle='_dropdown'>SIC</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/sgde' data-toggle='_dropdown'>SGDE</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/gicar' data-toggle='_dropdown'>GICAR</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/cs' data-toggle='_dropdown'>Centres de Suport</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/dadesref' data-toggle='_dropdown'>Gestió Tècnica de Dades</a>
						</li>

						

						<li>
							<a class="dropdown-toggle" href='/eventhub' data-toggle='_dropdown'>EventHub</a>
						</li>

						

					</ul>

				</nav>
			</div>
		</header>



	</div>

	<section class="border-start">

						
			

			<article class="bgGrey">
				<div class="container">
					<div class="row">
						<div class="capcelera_basica col-sm-12">
							<div class="capcelera_basica_cont">
								<ol class="breadcrumb filariana hidden-xs">
									<li>
										<a href="/">Inici</a>
									</li>
									<li class="breadcrumbs2">
									
										<a href="/canigo-documentacio-versions-34-integracio">
											




























										</a>
										


















	<a href="/canigo/">Framework Canigó</a> </li>
	<li>
		<a href="/canigo-documentacio/">Documentació</a>
	</li>

	<li>
		<a href="/canigo-documentacio-versions/">Versions</a>
	</li>

	<li>
		<a href="/canigo-documentacio-versions-34">Versió 3.4</a>
	</li>

	<li>
		
			<a href="/canigo-documentacio-versions-34-integracio">Mòduls d'Integració</a>
		












































































									
									</li>

								</ol>

								<h1 class="capcelera_flotant pull-left" data-txt=".title">
									

										
											




	Servei de Signatura Centralitzada - SSC


										

									
								</h1>

								

								
								

								

								

							</div>
						</div>

					</div>
				</div>
			</article>

			


		   <div class="padding-xs container">
	    	
	    	   <i><b>Darrera actualització:</b></i> 29-11-2019
	        
           </div>
           
			<article class="padding-xs padding-sm padding-md contingut">				
				<div class="container">
 		
					
				

	


					

						

<h2 id="introducció">Introducció</h2>

<p>L&rsquo;objectiu d&rsquo;aquest connector és proporcionar accés al Sistema de Signatura Centralitzada de Catcert (SSC). Aquest component, el qual es troba dins els connectors de serveis funcionals de la Generalitat, proporciona una interfície que utilitza l&rsquo;API SmartWrapper per poder donar accés als diferents tipus de signatura que ofereix l&rsquo;SSC.</p>

<p>Aquest document va dirigit als següents perfils:</p>

<ul>
<li>Programador. Per conèixer l&rsquo;ús del connector.</li>
<li>Arquitecte. Per conèixer quins són els components i la configuració del connector.</li>
</ul>

<h2 id="descripció-detallada">Descripció Detallada</h2>

<p>Aquest connector permet utilitzar els diferents serveis de signatura del SSC a través d&rsquo;una API que el mateix component ofereix. El nucli principal del SSC és el sistema TrustedX que ofereix l&rsquo;API SmartWrapper per poder treballar amb ell. És amb aquesta API amb la qual està constituït aquest connector.</p>

<p>Els principals serveis que ofereix el connector són els següents:</p>

<ul>
<li>Accés a la plataforma amb certificat: Totes les aplicacions que desitgin utilitzar l&rsquo;SSC hauran de disposar d&rsquo;un certificat amb el qual s&rsquo;autenticaran per utilitzar la plataforma. Aquest certificat s&rsquo;haurà de demanar a CatCert.</li>

<li><p>Ús de magatzem de certificats: Una de les principals funcionalitats del SSC és la signatura desatesa. Això s&rsquo;aconsegueix configurant en el connector un magatzem de certificats que l&rsquo;SSC utilitzarà per als diferents processos de signatura.</p></li>

<li><p>Tipus de signatura: L&rsquo;SSC ofereix els següents tipus de signatura.</p>

<ul>
<li>CMS: Attached / Detached / Detached Hash</li>
<li>CAdES-BES: Attached / Detached / Detached Hash</li>
<li>CAdES-T: Attached / Detached / Detached Hash</li>
<li>CMS-PDF: Attached / Detached</li>
<li>CAdES-BES-PDF: Attached / Detached</li>
<li>CAdES-T-PDF: Attached / Detached</li>
<li>XMLDSig: Enveloping / Enveloped / Detached / Detached Hash</li>
<li>XAdES-BES: Enveloping / Enveloped / Detached / Detached Hash</li>
<li>XAdES-T: Enveloping / Enveloped / Detached / Detached Hash</li>
</ul></li>

<li><p>Suport per a fitxers grans amb els tipus de signatura:</p>

<ul>
<li>CAdES-BES: Attached / Detached</li>
<li>CAdES-BES-PDF: Attached / Detached</li>
<li>XAdES-BES: Enveloping / Enveloped / Detached</li>
</ul></li>
</ul>

<p>Actualment el connector de Canigó de la versió 3.4 utilitza el client de SSC versió 1.3.3</p>

<h3 id="alta-servei">Alta Servei</h3>

<p>Per poder utilitzar l&rsquo;SSC en PRO s&rsquo;ha d&rsquo;estar donat d&rsquo;alta en el servei. Per poder fer-ho s&rsquo;han de seguir els següents passos:</p>

<ol>
<li><p>Enviar un correu electrònic a implantacio@aoc.cat sol·licitant l&rsquo;alta al servei. Aquí s&rsquo;espera que l&rsquo;usuari informi del tipus de signatures que vol generar i se l&rsquo;informarà del tipus de certificats que ha de sol- licitar.</p></li>

<li><p>Els certificats a sol·licitar s&rsquo;hauran de fer a través d&rsquo;EACAT.</p></li>

<li><p>Finalment, el client haurà d&rsquo;omplir un document d&rsquo;alta al SSC, on haurà d&rsquo;especificar el certificat amb el qual s&rsquo;autenticarà, així com els certificats de signatura allotjats en TrustedX que utilitzarà per signar.</p></li>

<li><p>Una vegada validat el document d&rsquo;alta, se li donarà accés al SSC en PRO.</p></li>
</ol>

<p>De cara a utilitzar el servei en PRE, els certificats i documentació necessària es poden demanar obrint una petició a suport@aoc.cat.</p>

<h3 id="arquitectura-i-components">Arquitectura i Components</h3>

<h4 id="interfícies-i-components-genèrics">Interfícies i Components Genèrics</h4>

<p>Si disposa de permís d&rsquo;accès al repositori del servidor Nexus del SIC, podrà trobar el codi font referent a aquests component a la següent URL: <a href="https://hudson.intranet.gencat.cat/nexus/#browse/search/maven=attributes.maven2.artifactId%3Dcanigo.integration.ssc:18ddeccdfb491ecba6cc83563709cf13">Codi Font Connector SSC</a>.</p>

<h4 id="requeriments">Requeriments</h4>

<p>El connector SSC, que utilitza el client 1.3.3 de SSC, està desenvolupat a Canigó 3.4. Canigó 3.4 només és compatible amb versions 1.8 o superior de Java, Spring 5 i Spring Boot 2. El connector SSC, que utilitza el client 1.3.3 de SSC, no és compatible amb versions anteriors de Canigó.</p>

<p>Per a versions 1.8 de Java a l&rsquo;entorn de Preproducció és necessari afegir la següent propietat per habilitar TLSv1.0:</p>

<pre><code>PropertyAllowTls10AsClient=true
</code></pre>

<p>Tal i com indica la a Guia d&rsquo;integració al SSC, aquest connector utilitza llibreries externes que es recomana revisar, ja que poden arribar a donar conflicte amb les llibreries d&rsquo;una aplicació ja desenvolupada.</p>

<h3 id="instal-lació-i-configuració">Instal·lació i Configuració</h3>

<h4 id="instal-lació">Instal·lació</h4>

<p>La instal·lació del connector requereix la utilització de la llibreria &lsquo;canigo.integration.ssc&rsquo;, per afegir aquesta dependència s&rsquo;ha de modificar el pom.xml de l&rsquo;aplicació per incloure la llibreria del Connector:</p>

<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;cat.gencat.ctti&lt;/groupId&gt;
    &lt;artifactId&gt;canigo.integration.ssc&lt;/artifactId&gt;
    &lt;version&gt;[2.2.0,2.3.0)&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h4 id="configuració">Configuració</h4>

<p>1.- Per poder configurar el connector SSC és necessari crear un arxiu anomenat app-integration-ssc.xml situat en src/main/resources/spring/ amb el següent contingut:</p>

<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans-4.3.xsd&quot;&gt;


    &lt;bean id=&quot;sscService&quot; class=&quot;cat.gencat.ctti.canigo.arch.integration.ssc.impl.SscConnectorImpl&quot;&gt;

        &lt;description&gt;
            SSC Service for Canigó 3.4
        &lt;/description&gt;

        &lt;property name=&quot;host&quot; value=&quot;${ssc.host}&quot; /&gt;
        &lt;property name=&quot;distinguishedname&quot; value=&quot;${ssc.distinguishedname}&quot; /&gt;
        &lt;property name=&quot;dipositari&quot; value=&quot;${ssc.dipositari}&quot; /&gt;
        &lt;property name=&quot;rol&quot; value=&quot;${ssc.rol}&quot; /&gt;
    &lt;/bean&gt;
    
&lt;/beans&gt;
</code></pre>

<p>on les variables ssc.host, ssc.distinguishedname, ssc.dipositari i ssc.rol són recuperades de l&rsquo;arxiu ssc.properties que s&rsquo;ha de crear en src/main/resources/config/props/ssc.properties</p>

<p>2.- Configuració dels arxius de <em>properties</em>, existeixen dos arxius de propietats per poder configurar l’SSC:</p>

<p>a) El ssc.properties, que conté els següents paràmetres:</p>

<ul>
<li><p>ssc.host: Url del servidor on es troba l&rsquo;SSC.</p>

<ul>
<li>PRE: <a href="https://ssc.preproduccio.catcert.cat:8443/trustedx-gw/SoapGateway">https://ssc.preproduccio.catcert.cat:8443/trustedx-gw/SoapGateway</a></li>
<li>PRO: <a href="https://ssc.catcert.cat:8443/trustedx-gw/SoapGatewayU1T">https://ssc.catcert.cat:8443/trustedx-gw/SoapGatewayU1T</a></li>
</ul></li>

<li><p>ssc.distinguishedname: Nom del certificat amb el qual l&rsquo;aplicació s&rsquo;autentica per consumir els serveis del SSC.</p></li>

<li><p>ssc.dipositari: Ens a afegir a la capçalera de la petició a SSCC.</p></li>

<li><p>ssc.rol: Rol d&rsquo;usuari a afegir a la capçalera de la petició a SSCC.</p></li>
</ul>

<p>b) El smartwrapper.properties conté la configuració de l&rsquo;API SmartWrapper de TrustedX i està documentat a la Guia d’integració al SSC.
La ubicació d&rsquo;aquest arxiu es recomana que sigui en el directori src/main/resources de l&rsquo;aplicació que utilitzi el connector.</p>

<p>NOTA: Les dades de proves del connector relacionades amb certificats de proves s&rsquo;han de demanar a CatCert.</p>

<h3 id="utilització-del-connector">Utilització del Connector</h3>

<p>1.- En el <em>bean</em> on es vulgui disposar dels serveis del connector declarar el servei.</p>

<pre><code class="language-java">@Autowired
private SscConnector sscConnector;
</code></pre>

<p>2.- Escollir una modalitat de signatura i passar-li els paràmetres que necessiti. En el cas d&rsquo;aquest exemple es farà una signatura CAdES-BES en mode ATTACHED.</p>

<pre><code class="language-java">final String filename = FILENAME_HELLOWORLD_TXT;

log.info(&quot;[INI][signCadesBesAttached]&quot;);

String inFilename = getInFilename(DOCS_TO_SIGN_PATH_IN, filename);
log.info(&quot;[INFO][Arxiu a signar: &quot; + inFilename);
String data = Util.readBinaryFileB64(inFilename);

String resposta = sscConnector.signCadesBes(data, Constants.ATTACHED);

String destFilename = getDestFilename(CADES_SIGNATURES_PATH_OUT + SEPARADOR_PATH, filename,
        &quot;_Signature_CAdES_BES_Attached.txt&quot;);
Util.writeBinaryFileB64(destFilename, resposta);
        
log.info(&quot;[INFO][Arxiu signat: &quot; + destFilename);

log.info(&quot;[FIN][signCadesBesAttached]&quot;);
</code></pre>

<p>On:</p>

<ul>
<li><p>FILENAME_HELLOWORLD_TXT: És el nom del fitxer a enviar.</p></li>

<li><p>DOCS_TO_SIGN_PATH_IN: És el <em>path</em> del fitxer a enviar.</p></li>

<li><p>CADES_SIGNATURES_PATH_OUT: És el <em>path</em> on guardar la resposta.</p></li>

<li><p>SEPARADOR_PATH: És el separador de <em>path</em> segons el sistema operatiu.</p></li>

<li><p>getInFilename: mètode que retorna el <em>path</em> i nom del fitxer a enviar.</p></li>

<li><p>getDestFilename: mètode que retorna el <em>path</em> i nom del fitxer on guardar la resposta.</p></li>
</ul>

<p>Per més informació sobre els diferents mètodes que ofereix el connector SSC es pot consultar l&rsquo;API, disponible consultant el codi font del connector SCC el qual es pot trobar al Nexus.</p>

<h2 id="documentació-de-referència">Documentació de referència</h2>

<p>Per més informació, es pot consultar la <a href="/related/canigo/documentacio/modul-ssc/guiaintegraciossc-v1-3-3.pdf" title="Guia Integració SSC">Guia d&rsquo;integració al SSC</a>.</p>


					

					
				</div>	

			</article>	


	</section>	

		<div class="fons_footer ">
		<footer class="container center-block shadowBox2">
			<div class="shadow2"></div>
			<div class="row footer_tab_ord">

				<div class="footer_tab_bot col-sm-12">
					<div class="avis_legal">

						<div id="fAvisLegal">
							<div>
								<div class="hidden-xs">
									<a href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" alt="www.gencat.cat"
										/></a>
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								<div class="visible-xs avis_legal">
									<p>
										<a title="Avis legal" href="https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/" target="_self">Avís legal</a>: La &copy; Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se citi la font i la data d'actualització, que no es desnaturalitzi la informació i que no es contradigui amb una llicència específica.
									</p>
								</div>
								
								<div class="fi_peu visible-xs">
									<a title="www.gencat.cat" href="https://www.gencat.cat"> <img
										src="/img/logo_generalitat_gris.png_679097835.png"
										width="101" height="27" 
										alt="www.gencat.cat" /></a> <a class="torna_amunt pull-right"
										href=" javascript:tornarAmunt();" title="Torna amunt">
										<p>Torna amunt</p>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</footer>
	</div>

<script src="/js/master.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
<script src="/js/custom.js" type="text/javascript"></script>



<script type="text/javascript">

if(location.hostname!=="localhost"){

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', "UA-59408075-1", 'auto');
	ga('send', 'pageview', {
	  	'page': location.pathname + location.search  + location.hash
	  }
	);

}

</script>




</body>
</html>
